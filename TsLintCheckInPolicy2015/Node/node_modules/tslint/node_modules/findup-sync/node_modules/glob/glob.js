function glob(n,t,i){if(typeof t=="function"&&(i=t,t={}),t||(t={}),typeof t=="number"){deprecated();return}var r=new Glob(n,t,i);return r.sync?r.found:r}function deprecated(){throw new Error("glob's interface has changed. Please see the docs.");}function globSync(n,t){if(typeof t=="number"){deprecated();return}return t=t||{},t.sync=!0,glob(n,t)}function Glob(n,t,i){function e(n,t){this._process(n,0,t,function(n){n&&this.emit("error",n);--f<=0&&this._finish()})}var r,u,f;if(!(this instanceof Glob))return new Glob(n,t,i);if(typeof t=="function"&&(i=t,t=null),typeof i=="function"){this.on("error",i);this.on("end",function(n){i(null,n)})}if(t=t||{},this._endEmitted=!1,this.EOF={},this._emitQueue=[],this.paused=!1,this._processingEmitQueue=!1,this.maxDepth=t.maxDepth||1e3,this.maxLength=t.maxLength||Infinity,this.cache=t.cache||{},this.statCache=t.statCache||{},this.changedCwd=!1,r=process.cwd(),t.hasOwnProperty("cwd")?(this.cwd=t.cwd,this.changedCwd=path.resolve(t.cwd)!==r):this.cwd=r,this.root=t.root||path.resolve(this.cwd,"/"),this.root=path.resolve(this.root),process.platform==="win32"&&(this.root=this.root.replace(/\\/g,"/")),this.nomount=!!t.nomount,!n)throw new Error("must provide pattern");if(t.matchBase&&-1===n.indexOf("/")){if(t.noglobstar)throw new Error("base matching requires globstar");n="**/"+n}this.strict=t.strict!==!1;this.dot=!!t.dot;this.mark=!!t.mark;this.sync=!!t.sync;this.nounique=!!t.nounique;this.nonull=!!t.nonull;this.nosort=!!t.nosort;this.nocase=!!t.nocase;this.stat=!!t.stat;this.debug=!!t.debug||!!t.globDebug;this.debug&&(this.log=console.error);this.silent=!!t.silent;u=this.minimatch=new Minimatch(n,t);this.options=u.options;n=this.pattern=u.pattern;this.error=null;this.aborted=!1;this._globstars={};EE.call(this);f=this.minimatch.set.length;this.matches=new Array(f);this.minimatch.set.forEach(e.bind(this))}function alphasorti(n,t){return n=n.toLowerCase(),t=t.toLowerCase(),alphasort(n,t)}function alphasort(n,t){return n>t?1:n<t?-1:0}function gsKey(n){return"**"+n.map(function(n){return n===minimatch.GLOBSTAR?"**":""+n}).join("/")}function absWin(n){if(absUnix(n))return!0;var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(n),i=t[1]||"",r=i&&i.charAt(1)!==":";return!!t[2]||r}function absUnix(n){return n.charAt(0)==="/"||n===""}var isAbsolute;module.exports=glob;var fs=require("fs"),minimatch=require("minimatch"),Minimatch=minimatch.Minimatch,inherits=require("inherits"),EE=require("events").EventEmitter,path=require("path"),isDir={},assert=require("assert").ok;glob.fnmatch=deprecated;glob.sync=globSync;this._processingEmitQueue=!1;glob.Glob=Glob;inherits(Glob,EE);Glob.prototype.log=function(){};Glob.prototype._finish=function(){var i,n,t,e,r,u,f;for(assert(this instanceof Glob),i=this.nounique,n=i?[]:{},t=0,e=this.matches.length;t<e;t++)r=this.matches[t],this.log("matches[%d] =",t,r),r?(f=Object.keys(r),i?n.push.apply(n,f):f.forEach(function(t){n[t]=!0})):this.nonull&&(u=this.minimatch.globSet[t],i?n.push(u):n[u]=!0);i||(n=Object.keys(n));this.nosort||(n=n.sort(this.nocase?alphasorti:alphasort));this.mark&&(n=n.map(this._mark,this));this.log("emitting end",n);this.EOF=this.found=n;this.emitMatch(this.EOF)};Glob.prototype._mark=function(n){var i=this.cache[n],t=n,r,u;return i&&(r=i===2||Array.isArray(i),u=n.slice(-1)==="/",r&&!u?t+="/":!r&&u&&(t=t.slice(0,-1)),t!==n&&(this.statCache[t]=this.statCache[n],this.cache[t]=this.cache[n])),t};Glob.prototype.abort=function(){this.aborted=!0;this.emit("abort")};Glob.prototype.pause=function(){this.paused||(this.sync&&this.emit("error",new Error("Can't pause/resume sync glob")),this.paused=!0,this.emit("pause"))};Glob.prototype.resume=function(){this.paused&&(this.sync&&this.emit("error",new Error("Can't pause/resume sync glob")),this.paused=!1,this.emit("resume"),this._processEmitQueue())};Glob.prototype.emitMatch=function(n){this.log("emitMatch",n);this._emitQueue.push(n);this._processEmitQueue()};Glob.prototype._processEmitQueue=function(n){var t,n,i,r;for(this.log("pEQ paused=%j processing=%j m=%j",this.paused,this._processingEmitQueue,n),t=!1;!this._processingEmitQueue&&!this.paused;){if(this._processingEmitQueue=!0,n=this._emitQueue.shift(),this.log(">processEmitQueue",n===this.EOF?":EOF:":n),!n){this.log(">processEmitQueue, falsey m");this._processingEmitQueue=!1;break}n!==this.EOF&&this.mark&&!this.stat?this.statCache[n]?(i=this.statCache[n],i&&(r=i.isDirectory()?2:1),this.log("peq: stat cached"),u.call(this,r,r===2)):(this.log("peq: _stat, then next"),this._stat(n,u)):(this.log("peq: unmarked, or eof"),u.call(this,0,!1));function u(i,r){this.log("next",n,i,r);var u=n===this.EOF?"end":"match";assert(!this._endEmitted);u==="end"&&(this._endEmitted=!0);i&&(r&&!n.match(/\/$/)?n=n+"/":!r&&n.match(/\/$/)&&(n=n.replace(/\/+$/,"")));this.log("emit",u,n);this.emit(u,n);this._processingEmitQueue=!1;t&&n!==this.EOF&&!this.paused&&this._processEmitQueue()}}t=!0};Glob.prototype._process=function(n,t,i,r){var e,f,u,o;if((assert(this instanceof Glob),e=function(n,t){if(assert(this instanceof Glob),this.paused){if(!this._processQueue){this._processQueue=[];this.once("resume",function(){var n=this._processQueue;this._processQueue=null;n.forEach(function(n){n()})})}this._processQueue.push(r.bind(this,n,t))}else r.call(this,n,t)}.bind(this),this.aborted)||t>this.maxDepth)return e();for(f=0;typeof n[f]=="string";)f++;switch(f){case n.length:u=n.join("/");this._stat(u,function(n){return n&&(u&&isAbsolute(u)&&!this.nomount&&(u=u.charAt(0)==="/"?path.join(this.root,u):path.resolve(this.root,u)),process.platform==="win32"&&(u=u.replace(/\\/g,"/")),this.matches[i]=this.matches[i]||{},this.matches[i][u]=!0,this.emitMatch(u)),e()});return;case 0:u=null;break;default:u=n.slice(0,f);u=u.join("/")}return u===null?o=".":isAbsolute(u)||isAbsolute(n.join("/"))?(u&&isAbsolute(u)||(u=path.join("/",u)),o=u=path.resolve(u),this.log("absolute: ",u,this.root,n,o)):o=u,this.log("readdir(%j)",o,this.cwd,this.root),this._readdir(o,function(r,o){var s,c,h;if(r)return e();if(n[f]===minimatch.GLOBSTAR){if(s=[n.slice(0,f).concat(n.slice(f+1))],o.forEach(function(t){(t.charAt(0)!=="."||this.dot)&&(s.push(n.slice(0,f).concat(t).concat(n.slice(f+1))),s.push(n.slice(0,f).concat(t).concat(n.slice(f))))},this),s=s.filter(function(n){var t=gsKey(n),i=!this._globstars[t];return this._globstars[t]=!0,i},this),!s.length)return e();c=s.length;h=null;s.forEach(function(n){this._process(n,t+1,i,function(n){if(!h)return n?e(h=n):--c<=0?e():void 0})},this);return}var v=n[f],l=n[f]._glob,a=this.dot||l.charAt(0)===".";if(o=o.filter(function(t){return(t.charAt(0)!=="."||a)&&t.match(n[f])}),f===n.length-1&&!this.mark&&!this.stat)return o.forEach(function(n){u&&(n=u!=="/"?u+"/"+n:u+n);n.charAt(0)!=="/"||this.nomount||(n=path.join(this.root,n));process.platform==="win32"&&(n=n.replace(/\\/g,"/"));this.matches[i]=this.matches[i]||{};this.matches[i][n]=!0;this.emitMatch(n)},this),e.call(this);if(c=o.length,h=null,c===0)return e();o.forEach(function(r){var u=n.slice(0,f).concat(r).concat(n.slice(f+1));this._process(u,t+1,i,function(n){if(!h)return n?e(h=n):--c==0?e.call(this):void 0})},this)})};Glob.prototype._stat=function(n,t){var i,u,e,f,r;if(assert(this instanceof Glob),i=n,n.charAt(0)==="/"?i=path.join(this.root,n):this.changedCwd&&(i=path.resolve(this.cwd,n)),n.length>this.maxLength)return r=new Error("Path name too long"),r.code="ENAMETOOLONG",r.path=n,this._afterStat(n,i,t,r);if(this.log("stat",[this.cwd,n,"=",i]),!this.stat&&this.cache.hasOwnProperty(n))return(u=this.cache[n],e=u&&(Array.isArray(u)||u===2),this.sync)?t.call(this,!!u,e):process.nextTick(t.bind(this,!!u,e));if(f=this.statCache[i],this.sync||f){try{f=fs.statSync(i)}catch(o){r=o}this._afterStat(n,i,t,r,f)}else fs.stat(i,this._afterStat.bind(this,n,i,t))};Glob.prototype._afterStat=function(n,t,i,r,u){var f,e;assert(this instanceof Glob);t.slice(-1)==="/"&&u&&!u.isDirectory()&&(this.log("should be ENOTDIR, fake it"),r=new Error("ENOTDIR, not a directory '"+t+"'"),r.path=t,r.code="ENOTDIR",u=null);e=!this.statCache[t];this.statCache[t]=u;r||!u?f=!1:(f=u.isDirectory()?2:1,e&&this.emit("stat",n,u));this.cache[n]=this.cache[n]||f;i.call(this,!!f,f===2)};Glob.prototype._readdir=function(n,t){var r,u,f,i,e;if(assert(this instanceof Glob),r=n,n.charAt(0)==="/"?r=path.join(this.root,n):isAbsolute(n)?r=n:this.changedCwd&&(r=path.resolve(this.cwd,n)),n.length>this.maxLength)return i=new Error("Path name too long"),i.code="ENAMETOOLONG",i.path=n,this._afterReaddir(n,r,t,i);if(this.log("readdir",[this.cwd,n,r]),this.cache.hasOwnProperty(n)){if(u=this.cache[n],Array.isArray(u))return this.sync?t.call(this,null,u):process.nextTick(t.bind(this,null,u));if(!u||u===1)return(f=u?"ENOTDIR":"ENOENT",i=new Error((u?"Not a directory":"Not found")+": "+n),i.path=n,i.code=f,this.log(n,i),this.sync)?t.call(this,i):process.nextTick(t.bind(this,i))}if(this.sync){try{e=fs.readdirSync(r)}catch(o){i=o}return this._afterReaddir(n,r,t,i,e)}fs.readdir(r,this._afterReaddir.bind(this,n,r,t))};Glob.prototype._afterReaddir=function(n,t,i,r,u){if(assert(this instanceof Glob),u&&!r)return this.cache[n]=u,this.mark||this.stat||u.forEach(function(t){t=n==="/"?n+t:n+"/"+t;this.cache[t]=!0},this),i.call(this,r,u);if(r)switch(r.code){case"ENOTDIR":return this.cache[n]=1,i.call(this,r);case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":return this.cache[n]=!1,i.call(this,r);default:return this.cache[n]=!1,this.strict&&this.emit("error",r),this.silent||console.error("glob error",r),i.call(this,r)}};isAbsolute=process.platform==="win32"?absWin:absUnix