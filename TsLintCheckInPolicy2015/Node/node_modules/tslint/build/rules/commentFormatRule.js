var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},OPTION_SPACE="check-space",OPTION_LOWERCASE="check-lowercase",Rule=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.apply=function(n){return this.applyWithWalker(new CommentWalker(n,this.getOptions()))},t.LOWERCASE_FAILURE="comment must start with lowercase letter",t.LEADING_SPACE_FAILURE="comment must start with a space",t}(Lint.Rules.AbstractRule),CommentWalker;exports.Rule=Rule;CommentWalker=function(n){function t(t,i){n.call(this,t,i);this.tokensToSkipStartEndMap={}}return __extends(t,n),t.prototype.visitSourceFile=function(t){var i=this;n.prototype.visitSourceFile.call(this,t);Lint.scanAllTokens(ts.createScanner(1,!1,t.text),function(n){var r=n.getStartPos(),e,o;if(i.tokensToSkipStartEndMap[r]!=null){n.setTextPos(i.tokensToSkipStartEndMap[r]);return}if(n.getToken()===2){var t=n.getTokenText(),u=n.getTokenPos()+2,f=t.length-2;i.hasOption(OPTION_SPACE)&&(i.startsWithSpace(t)||(e=i.createFailure(u,f,Rule.LEADING_SPACE_FAILURE),i.addFailure(e)));i.hasOption(OPTION_LOWERCASE)&&(i.startsWithLowercase(t)||(o=i.createFailure(u,f,Rule.LOWERCASE_FAILURE),i.addFailure(o)))}})},t.prototype.visitRegularExpressionLiteral=function(t){this.addTokenToSkipFromNode(t);n.prototype.visitRegularExpressionLiteral.call(this,t)},t.prototype.visitIdentifier=function(t){this.addTokenToSkipFromNode(t);n.prototype.visitIdentifier.call(this,t)},t.prototype.visitTemplateExpression=function(t){this.addTokenToSkipFromNode(t);n.prototype.visitTemplateExpression.call(this,t)},t.prototype.addTokenToSkipFromNode=function(n){n.getStart()<n.getEnd()&&(this.tokensToSkipStartEndMap[n.getStart()]=n.getEnd())},t.prototype.startsWithSpace=function(n){if(n.length<=2||/^#(end)?region/.test(n.substring(2)))return!0;var t=n.charAt(2);return t===" "||t==="/"},t.prototype.startsWithLowercase=function(n){var t,i;return n.length<=2?!0:(t=n.match(/^\/\/\s*(\w)/),t!=null?(i=t[1],i===i.toLowerCase()):!0)},t}(Lint.RuleWalker)