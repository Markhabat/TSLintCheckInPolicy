var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},Rule=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.apply=function(n){var t=ts.createDocumentRegistry(),i=Lint.createLanguageServiceHost("file.ts",n.getFullText()),r=ts.createLanguageService(i,t);return this.applyWithWalker(new NoUseBeforeDeclareWalker(n,this.getOptions(),r))},t.FAILURE_STRING_PREFIX="variable '",t.FAILURE_STRING_POSTFIX="' used before declaration",t}(Lint.Rules.AbstractRule),NoUseBeforeDeclareWalker;exports.Rule=Rule;NoUseBeforeDeclareWalker=function(n){function t(t,i,r){n.call(this,t,i);this.languageService=r}return __extends(t,n),t.prototype.createScope=function(){return{}},t.prototype.visitImportDeclaration=function(t){this.validateUsageForVariable(t.name.text,t.name.getStart());n.prototype.visitImportDeclaration.call(this,t)},t.prototype.visitVariableDeclaration=function(t){var i=t.name.text,r=this.getCurrentScope();r[i]==null&&this.validateUsageForVariable(i,t.getStart());r[i]=!0;n.prototype.visitVariableDeclaration.call(this,t)},t.prototype.validateUsageForVariable=function(n,t){var i=this,r=this.languageService.getReferencesAtPosition("file.ts",t);r&&r.forEach(function(r){var u=r.textSpan.start(),f,e;u<t&&(f=Rule.FAILURE_STRING_PREFIX+n+Rule.FAILURE_STRING_POSTFIX,e=i.createFailure(u,n.length,f),i.addFailure(e))})},t}(Lint.ScopeAwareRuleWalker)