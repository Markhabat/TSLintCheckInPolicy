var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},Rule=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.apply=function(n){return this.applyWithWalker(new JsdocWalker(n,this.getOptions()))},t.ALIGNMENT_FAILURE_STRING="asterisks in jsdoc must be aligned",t.FORMAT_FAILURE_STRING="jsdoc is not formatted correctly on this line",t}(Lint.Rules.AbstractRule),JsdocWalker;exports.Rule=Rule;JsdocWalker=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.visitSourceFile=function(n){var t=this;Lint.scanAllTokens(ts.createScanner(1,!1,n.text),function(i){if(i.getToken()===3){var r=i.getTokenText(),u=i.getTokenPos();t.findFailuresForJsdocComment(r,u,n)}})},t.prototype.findFailuresForJsdocComment=function(n,t,i){var s=this,h=t,u=n.split("\n"),r=h,f=u[0],y=f.match(/^\s*\/\*\*/),c,o,l,e,a,v;if(y!=null){if(u.length===1){c=f.match(/^\s*\/\*\* (.* )?\*\/$/);c==null&&this.addFailureAt(r,f.length,Rule.FORMAT_FAILURE_STRING);return}o=f.indexOf("**")+i.getLineAndCharacterFromPosition(h).character-1;l=u.splice(1,u.length-2);r+=f.length+1;l.forEach(function(n){var i=n.match(/^\s*\*( |$)/),t;i==null&&s.addFailureAt(r,n.length,Rule.FORMAT_FAILURE_STRING);t=n.indexOf("*");t!==o&&s.addFailureAt(r,n.length,Rule.ALIGNMENT_FAILURE_STRING);r+=n.length+1});e=u[u.length-1];a=e.match(/^\s*\*\/$/);a==null&&this.addFailureAt(r,e.length,Rule.FORMAT_FAILURE_STRING);v=e.indexOf("*");v!==o&&this.addFailureAt(r,e.length,Rule.ALIGNMENT_FAILURE_STRING)}},t.prototype.addFailureAt=function(n,t,i){var r=this.createFailure(n,t,i);this.addFailure(r)},t}(Lint.RuleWalker)