function hasKey(n,t){var i=n,r;return t.slice(0,-1).forEach(function(n){i=i[n]||{}}),r=t[t.length-1],r in i}function setKey(n,t,i){var r=n,u;t.slice(0,-1).forEach(function(n){r[n]===undefined&&(r[n]={});r=r[n]});u=t[t.length-1];r[u]===undefined||typeof r[u]=="boolean"?r[u]=i:Array.isArray(r[u])?r[u].push(i):r[u]=[r[u],i]}function isNumber(n){return typeof n=="number"?!0:/^0x[0-9a-f]+$/i.test(n)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(n)}module.exports=function(n,t){function o(n,t){var i=!f.strings[n]&&isNumber(t)?Number(t):t;setKey(l,n.split("."),i);(e[n]||[]).forEach(function(n){setKey(l,n.split("."),i)})}var f,e,a,l,y,r,u,p,c,v,s,h,i;for(t||(t={}),f={bools:{},strings:{}},[].concat(t.boolean).filter(Boolean).forEach(function(n){f.bools[n]=!0}),e={},Object.keys(t.alias||{}).forEach(function(n){e[n]=[].concat(t.alias[n]);e[n].forEach(function(t){e[t]=[n].concat(e[n].filter(function(n){return t!==n}))})}),[].concat(t.string).filter(Boolean).forEach(function(n){f.strings[n]=!0;e[n]&&(f.strings[e[n]]=!0)}),a=t["default"]||{},l={_:[]},Object.keys(f.bools).forEach(function(n){o(n,a[n]===undefined?!1:a[n])}),y=[],n.indexOf("--")!==-1&&(y=n.slice(n.indexOf("--")+1),n=n.slice(0,n.indexOf("--"))),r=0;r<n.length;r++)if(u=n[r],/^--.+=/.test(u))p=u.match(/^--([^=]+)=([\s\S]*)$/),o(p[1],p[2]);else if(/^--no-.+/.test(u))i=u.match(/^--no-(.+)/)[1],o(i,!1);else if(/^--.+/.test(u))i=u.match(/^--(.+)/)[1],h=n[r+1],h===undefined||/^-/.test(h)||f.bools[i]||(e[i]?f.bools[e[i]]:!1)?/^(true|false)$/.test(h)?(o(i,h==="true"),r++):o(i,f.strings[i]?"":!0):(o(i,h),r++);else if(/^-[^-]+/.test(u)){for(c=u.slice(1,-1).split(""),v=!1,s=0;s<c.length;s++){if(h=u.slice(s+2),h==="-"){o(c[s],h);continue}if(/[A-Za-z]/.test(c[s])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(h)){o(c[s],h);v=!0;break}if(c[s+1]&&c[s+1].match(/\W/)){o(c[s],u.slice(s+2));v=!0;break}else o(c[s],f.strings[c[s]]?"":!0)}i=u.slice(-1)[0];v||i==="-"||(!n[r+1]||/^(-|--)[^-]/.test(n[r+1])||f.bools[i]||(e[i]?f.bools[e[i]]:!1)?n[r+1]&&/true|false/.test(n[r+1])?(o(i,n[r+1]==="true"),r++):o(i,f.strings[i]?"":!0):(o(i,n[r+1]),r++))}else l._.push(f.strings._||!isNumber(u)?u:Number(u));return Object.keys(a).forEach(function(n){hasKey(l,n.split("."))||(setKey(l,n.split("."),a[n]),(e[n]||[]).forEach(function(t){setKey(l,t.split("."),a[n])}))}),y.forEach(function(n){l._.push(n)}),l}